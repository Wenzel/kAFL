Search.setIndex({"docnames": ["how_to/linux_tutorial", "how_to/sharedir_tutorial", "how_to/windows_tutorial", "index", "reference/hypercall_api", "tutorials/getting_started"], "filenames": ["how_to/linux_tutorial.md", "how_to/sharedir_tutorial.md", "how_to/windows_tutorial.md", "index.md", "reference/hypercall_api.md", "tutorials/getting_started.md"], "titles": ["Getting Started with Linux Fuzzing", "Using Nyx htools + sharedir for OS Fuzzing", "Getting Started with Windows Fuzzing", "\ud83d\udcd7 kAFL\u2019s Documentation", "kAFL/Nyx Hypercall API", "Getting started"], "terms": {"base": [0, 5], "legaci": [0, 2], "kafl": [0, 1, 2, 5], "guid": [0, 2, 5], "run": [0, 1, 2, 3, 5], "newer": [0, 4, 5], "distribut": 0, "mai": [0, 1, 2, 4], "requir": [0, 1, 3], "minor": 0, "fix": [0, 1, 2], "provid": [0, 1], "sampl": [0, 1], "code": [0, 1, 3, 4], "For": [0, 1, 2, 3, 4], "follow": [0, 2, 3, 5], "step": [0, 2, 3], "download": [0, 1, 2], "ubuntu": [0, 1, 2, 5], "16": 0, "04": [0, 1, 2, 5], "iso": [0, 2], "last": 0, "verifi": 0, "work": [0, 1, 2, 5], "version": [0, 1, 4], "wget": 0, "c": [0, 1, 2, 4], "o": [0, 3, 5], "http": 0, "releas": [0, 4], "com": [0, 3], "7": 0, "server": [0, 2], "amd64": 0, "creat": [0, 2, 3, 4], "qemu": [0, 1, 2, 3, 4], "hard": [0, 2], "drive": [0, 2], "img": [0, 2], "f": [0, 2], "qcow2": [0, 1, 2], "20g": 0, "machin": [0, 2, 5], "q35": [0, 2], "enabl": [0, 2, 4], "kvm": [0, 2, 3], "m": [0, 2], "1024": [0, 2], "hda": [0, 2], "cdrom": [0, 2], "insid": [0, 1, 5], "guest": [0, 1, 3, 4], "clone": [0, 5], "repositori": [0, 3], "agent": [0, 1, 2, 4, 5], "git": 0, "github": 0, "intellab": [0, 3], "sh": [0, 1, 2], "target": [0, 1, 2, 3, 4], "perform": [0, 1, 4], "ani": [0, 1, 3, 4], "other": [0, 1, 2, 3, 4], "setup": [0, 1, 5], "up": 0, "updat": [0, 1, 5], "grub": [0, 1], "spectre_v2": [0, 1], "off": [0, 1], "mitig": [0, 1], "nopti": [0, 1], "oop": [0, 1], "panic": [0, 1, 4], "nokaslr": [0, 1], "consol": [0, 1, 2], "ttys0": [0, 1], "sudo": [0, 1, 2, 5], "sysctl": 0, "kernel": [0, 1, 3, 5], "randomize_va_spac": 0, "0": [0, 2], "shutdown": [0, 2], "gener": [0, 2, 3, 4], "directli": [0, 1, 2, 5], "desir": [0, 3], "hierarchi": 0, "help": 0, "result": [0, 1, 4], "smaller": 0, "footprint": 0, "The": [0, 1, 3, 4, 5], "snippet": 0, "minim": [0, 1, 3, 4], "root": [0, 1, 5], "us": [0, 2, 3, 4, 5], "debootstrap": 0, "hello": [0, 1], "world": [0, 1], "kafl_vuln_test": [0, 1], "test": [0, 1, 2, 4, 5], "case": [0, 4, 5], "tend": 0, "have": [0, 1, 2, 4], "similar": 0, "tool": [0, 1], "e": [0, 1, 4], "g": [0, 1, 4], "febootstrap": 0, "fedora": 0, "you": [0, 1, 2, 4, 5], "can": [0, 1, 2, 4, 5], "also": [0, 1, 4], "busybox": 0, "further": [0, 1, 3], "reduc": 0, "memori": [0, 2], "your": [0, 1, 2, 5], "har": [0, 1, 4, 5], "rootf": 0, "cd": [0, 1], "realpath": 0, "ubuntu_16": 0, "mkdir": [0, 1, 2], "p": [0, 1], "arch": 0, "variant": 0, "minbas": 0, "includ": [0, 1], "vim": 0, "ssh": 0, "xenial": 0, "archiv": 0, "deploi": [0, 3, 5], "loader": [0, 2, 3], "we": [0, 1, 2, 4], "current": [0, 1, 2, 4], "host": [0, 1, 2, 4, 5], "here": [0, 1, 2], "so": [0, 2, 4], "don": 0, "t": [0, 2], "worri": 0, "about": [0, 4], "cross": [0, 1], "compil": [0, 1, 2], "port": 0, "compon": [0, 1], "choic": 0, "lib": 0, "modul": [0, 1, 5], "cp": [0, 1, 2], "unam": 0, "r": 0, "boot": [0, 1], "fuzzer": [0, 1, 2, 3, 4], "depend": 0, "linux_x86_64": [0, 1], "bin": [0, 1, 2], "pushd": 0, "test_cas": [0, 1], "simpl": [0, 1, 5], "linux_x86": [0, 1], "64": [0, 1, 4], "make": [0, 1, 4, 5], "ko": [0, 1], "popd": 0, "launch": [0, 2, 3, 5], "tee": [0, 1], "etc": [0, 1, 4], "rc": 0, "local": [0, 1, 5], "modprob": [0, 1, 2], "loop": [0, 1, 4], "vfat": 0, "insmod": 0, "set": [0, 1, 4], "password": [0, 5], "easi": [0, 3], "login": [0, 2], "debug": [0, 2, 4], "chroot": 0, "passwd": 0, "wrap": 0, "time": [0, 1, 4], "need": [0, 1, 2, 4], "aggreg": 0, "regular": [0, 1, 4], "file": [0, 1, 2, 4, 5], "mkf": 0, "ext4": 0, "l": 0, "n": [0, 1], "d": [0, 1], "2g": 0, "convert": 0, "raw": 0, "note": [0, 2, 3, 5], "thi": [0, 1, 2, 4, 5], "wai": [0, 1, 2], "doe": [0, 1, 2], "bootload": 0, "initrd": 0, "sinc": [0, 2, 4, 5], "ha": [0, 1, 5], "been": [0, 5], "proce": 0, "creation": 0, "final": 0, "configur": [0, 1, 4], "when": [0, 1, 4], "must": [0, 1, 4], "ident": 0, "one": [0, 2, 5], "restor": [0, 4], "later": 0, "dure": 0, "i": [0, 1, 2, 3, 4, 5], "adjust": 0, "ram": [0, 5], "size": [0, 4], "type": [0, 4], "peripher": 0, "avail": [0, 5], "even": [0, 1], "thing": 0, "like": [0, 2, 3, 4], "miss": 0, "commandlin": 0, "incompat": 0, "against": 0, "report": [0, 4], "log": [0, 1, 2, 4], "kafl_fuzz": [0, 1, 2], "py": [0, 1, 2], "v": [0, 2], "an": [0, 1, 3, 4, 5], "overlai": [0, 2], "copi": [0, 2], "multipl": [0, 3], "instanc": [0, 1, 3], "parallel": [0, 3], "b": [0, 2], "overlay_0": [0, 2], "execut": [0, 1, 2, 3, 4], "initi": [0, 1, 4], "If": [0, 1, 5], "path": [0, 2], "abov": 0, "snip": 0, "correspond": [0, 1, 2, 4], "direct": 0, "automat": [0, 1, 4], "5": [0, 2], "x86_64": [0, 2], "softmmu": [0, 2], "system": [0, 1, 2, 3], "nograph": 0, "net": [0, 2], "none": [0, 2], "serial": [0, 1], "mon": 0, "stdio": 0, "vmlinuz": 0, "512": [0, 1], "append": 0, "dev": [0, 1, 2], "sda": 0, "rw": 0, "wa": [0, 1], "info": [0, 1, 2, 4], "seq": 0, "nproc": 0, "do": [0, 2], "overlay_": 0, "done": [0, 1, 2, 4], "virtual": [0, 4], "address": [0, 1, 4], "rang": [0, 1, 4], "trace": [0, 1, 4], "coverag": [0, 3, 5], "feedback": [0, 3, 4, 5], "It": [0, 2, 3, 4], "recommend": [0, 1], "specif": [0, 4], "subsystem": 0, "want": [0, 2], "order": [0, 3], "nois": 0, "schedul": [0, 3], "interrupt": 0, "To": [0, 1, 2, 5], "obtain": [0, 4], "driver": [0, 1], "kafl_info": [0, 2], "script": [0, 2, 3], "feed": 0, "binari": [0, 1, 2, 4], "where": [0, 2, 4], "scan": 0, "output": [0, 1, 2], "all": [0, 1, 3, 5], "purg": [0, 1, 2], "vm_dir": [0, 2], "mem": [0, 1, 2], "work_dir": [0, 1, 2, 4], "exampl": [0, 1, 3], "0xffffffffc0022000": 0, "0xffffffffc0042000": 0, "psmous": 0, "0xffffffffc0010000": 0, "0xffffffffc001a000": 0, "ahci": 0, "0xffffffffc0002000": 0, "0xffffffffc000a000": 0, "0xffffffff81000000": 0, "0xffffffff81a4aea0": 0, "core": 0, "pt": [0, 2, 3, 4, 5], "filter": [0, 1, 4], "seed": [0, 1, 2], "echo": [0, 1, 2], "abcdefg1234567890": 0, "seed_dir": [0, 1, 2], "ip0": [0, 2], "view": 0, "progress": 0, "troubleshoot": 0, "sens": 0, "dir": 0, "continu": [0, 4, 5], "main": [0, 1, 3], "tbd": 0, "see": [0, 2], "readm": 0, "md": 0, "window": [0, 3, 5], "option": [1, 2, 3], "replac": 1, "v0": 1, "2": 1, "old": 1, "singl": [1, 4], "kind": [1, 4], "fanci": 1, "packag": 1, "approach": [1, 4], "With": 1, "shell": [1, 5], "which": [1, 2, 3, 4, 5], "turn": 1, "load": 1, "addit": 1, "via": 1, "hypercal": [1, 3], "transpar": 1, "todo": 1, "ar": [1, 2, 4, 5], "integr": [1, 3], "sourc": 1, "separ": 1, "from": [1, 2, 3, 4], "packer": 1, "avoid": 1, "frequent": 1, "modif": [1, 3, 5], "purpos": [1, 2], "second": 1, "stage": 1, "dub": 1, "below": 1, "actual": [1, 2, 4], "non": 1, "patch": 1, "recent": [1, 5], "most": [1, 2], "20": [1, 2, 5], "consid": 1, "same": 1, "problem": [1, 2], "activ": 1, "disabl": [1, 4], "kaslr": 1, "pti": 1, "default": [1, 2], "grub_cmdline_linux_default": 1, "grub_cmdline_linux": 1, "grub_timeout_styl": 1, "menu": 1, "grub_timeout": 1, "1": [1, 2], "grub_disable_recoveri": 1, "true": 1, "mount": [1, 2], "bash": 1, "nbd": [1, 2], "nbd0": [1, 2], "nbd0p1": 1, "mnt": [1, 2], "hget": 1, "chmod": 1, "x": 1, "reboot": 1, "manual": [1, 2, 4], "snapshot": [1, 3, 4, 5], "lock": [1, 4], "still": 1, "some": 1, "instead": [1, 2, 4], "cron": 1, "sure": [1, 5], "instal": [1, 2, 3], "crontab": 1, "unount": 1, "disconnect": [1, 2], "import": 1, "umount": [1, 2], "vulner": 1, "hprintf_test": 1, "review": 1, "understand": 1, "startup": [1, 4], "flow": 1, "secret": 1, "ingredi": 1, "issu": [1, 4, 5], "fetch": [1, 4], "store": [1, 4], "runtim": [1, 3], "select": 1, "ip": [1, 4], "reason": 1, "decod": [1, 3, 4], "while": [1, 4], "possibl": [1, 2, 5], "suppli": [1, 4], "paramet": [1, 2], "": [1, 2, 5], "part": [1, 2, 4], "combin": [1, 4], "hinfo": 1, "hrang": 1, "accomplish": 1, "origin": 1, "simpli": [1, 4], "dump": [1, 4], "take": [1, 4], "list": [1, 2], "them": 1, "A": [1, 5], "seen": 1, "stdout": 1, "redirect": 1, "hcat": 1, "grep": 1, "pipe": 1, "kafl_vuln": 1, "awk": 1, "print": [1, 4], "nr": 1, "xarg": 1, "usag": 1, "custom": [1, 3, 4], "python3": [1, 5], "redqueen": [1, 3], "vm_imag": 1, "shm": 1, "kafl_ubuntu": 1, "By": 1, "now": [1, 2, 4, 5], "workdir": 1, "qemu_serial_": 1, "ampl": 1, "frontend": [1, 3, 4], "hprintf": [1, 4], "send": [1, 4], "printf": [1, 4], "string": [1, 4], "python": [1, 3], "immedi": 1, "messag": 1, "togeth": 1, "switch": [1, 2], "more": [1, 3, 4], "verbos": 1, "At": [1, 2], "point": [1, 2, 4, 5], "unpatch": 1, "special": [1, 2, 4], "mode": 1, "exit": [1, 4], "error": [1, 2, 4], "intend": 1, "baselin": 1, "bootstrap": [1, 4], "differ": [1, 2], "scenario": [1, 3], "outsid": 1, "environ": 1, "own": 1, "extract": [1, 3], "function": [1, 4], "hook": 1, "In": [1, 2, 4], "particular": [1, 3], "typic": [1, 3, 4], "fail": [1, 2], "enough": 1, "just": [1, 2, 5], "complex": 1, "static": 1, "link": [1, 5], "librari": [1, 2, 3], "encount": 1, "first": [1, 2, 4, 5], "next_payload": [1, 4], "mean": [1, 2, 4], "okai": 1, "longer": 1, "phase": 1, "befor": [1, 4], "start": [1, 3, 4], "onli": [1, 2, 4], "after": [1, 2], "resum": [1, 4], "statu": 1, "its": [1, 5], "wait": 1, "state": 1, "due": 1, "bootup": 1, "ll": 2, "2019": 2, "evalu": 2, "17763": 2, "737": 2, "190906": 2, "2324": 2, "rs5_release_svc_refresh_server_eval_x64fre_en": 2, "us_1": 2, "50g": 2, "everyth": 2, "seem": 2, "nat": 2, "network": 2, "give": 2, "access": [2, 5], "well": [2, 3], "internet": 2, "move": 2, "anywher": 2, "els": 2, "correct": 2, "directori": 2, "windows_x86_64": 2, "ex": 2, "build": 2, "mingw": 2, "suggest": 2, "disk": 2, "connect": 2, "sleep": 2, "nbd0p2": 2, "rmdir": 2, "without": 2, "should": 2, "eventu": 2, "shut": 2, "down": 2, "probabl": 2, "freez": 2, "desktop": 2, "manag": [2, 5], "ctrl": 2, "alt": 2, "f3": 2, "killal": 2, "9": 2, "back": 2, "f1": 2, "check": [2, 3, 5], "congratz": 2, "readi": 2, "next": [2, 3, 4], "payload": [2, 4], "fed": 2, "map": 2, "pass": 2, "0xfffff801ecf00000": 2, "0xfffff801ecf18000": 2, "lltdio": 2, "sy": 2, "0xfffff801ecf20000": 2, "0xfffff801ecf3b000": 2, "rspndr": 2, "0xfffff801ecf40000": 2, "0xfffff801ecf65000": 2, "bowser": 2, "0xfffff801ecf70000": 2, "0xfffff801ecf8a000": 2, "mpsdrv": 2, "find": 2, "rememb": 2, "two": 2, "As": 2, "consequ": 2, "occur": 2, "exist": [2, 4], "ini": 2, "absolut": 2, "preffer": 2, "fatal": [2, 4], "pleas": [2, 3], "errno": 2, "104": 2, "reset": [2, 3], "peer": 2, "usual": 2, "mismatch": 2, "command": 2, "again": 2, "argument": 2, "ad": [2, 4], "afterward": 2, "cpu": [2, 5], "anoth": 2, "forgot": 2, "hang": [2, 4], "pci": 2, "devic": 2, "0123456789abcdef": 2, "modifi": [2, 3], "src": 2, "vuln_test": 2, "chang": 2, "call": 2, "properli": 2, "0xfffff801ec850000": 2, "0xfffff801ec915000": 2, "add": 2, "too": 2, "kafl_gui": 2, "observ": 2, "nyx": 3, "fast": 3, "x86": 3, "vm": [3, 4, 5], "great": 3, "anyth": 3, "firmwar": 3, "full": 3, "blown": 3, "oper": 3, "intel": [3, 5], "vt": 3, "pml": 3, "achiev": 3, "effici": 3, "greybox": 3, "whitebox": 3, "fuzz": [3, 4, 5], "allow": 3, "mani": 3, "fw": 3, "toolchain": 3, "written": 3, "design": 3, "afl": 3, "extend": [3, 4], "mutat": 3, "analysi": 3, "radamsa": 3, "grimoir": 3, "extens": 3, "introspect": 3, "input": [3, 4], "condit": 3, "instruct": 3, "overcom": 3, "magic": 3, "byte": 3, "attempt": 3, "identifi": 3, "keyword": 3, "syntax": 3, "clever": 3, "larg": [3, 4], "scale": 3, "detail": 3, "ijon": 3, "visit": 3, "project": 3, "structur": 3, "around": 3, "organis": 3, "subcompon": 3, "libxdc": [3, 4], "get": [3, 4], "linux": [3, 5], "prepar": 3, "imag": 3, "htool": 3, "sharedir": [3, 4], "api": 3, "essenti": 3, "untest": 3, "fulli": 3, "coordin": 4, "offer": [4, 5], "low": 4, "level": 4, "interfac": 4, "control": 4, "inject": 4, "acquir": 4, "collect": 4, "mark": 4, "stop": 4, "One": 4, "handshak": 4, "reach": 4, "return": 4, "ok": 4, "backend": 4, "get_payload": 4, "tell": 4, "write": 4, "care": 4, "alloc": 4, "suffici": [4, 5], "buffer": 4, "page": 4, "align": 4, "mmap": 4, "share": 4, "trigger": 4, "previous": 4, "regist": 4, "invoc": 4, "our": 4, "alwai": 4, "anymor": 4, "pointer": 4, "veri": 4, "forward": 4, "sanit": 4, "except": 4, "stack": 4, "kasan": 4, "rais": 4, "crash": 4, "event": 4, "reload": 4, "submit_pan": 4, "submit_kasan": 4, "handler": 4, "overwrit": 4, "detect": 4, "side": 4, "rewrit": 4, "unexpect": 4, "inlin": 4, "macro": 4, "often": 4, "prefer": 4, "flexibl": 4, "place": 4, "range_submit": 4, "known": 4, "easier": 4, "overrid": 4, "ipn": 4, "submit_cr3": 4, "cr3": 4, "valu": 4, "limit": 4, "task": 4, "context": 4, "user_abort": 4, "signal": 4, "mainli": 4, "assert": 4, "perspect": 4, "auto": 4, "user_submit_mod": 4, "explicitli": 4, "32": 4, "bit": 4, "influenc": 4, "possibli": 4, "set_agent_config": 4, "capabl": 4, "get_host_config": 4, "queri": 4, "req_stream_data": 4, "name": 4, "data": 4, "correspondingli": 4, "folder": 4, "dump_fil": 4, "null": 4, "valid": 4, "mkstemp": 4, "templat": 4, "filenam": 4, "let": 4, "uniqu": 4, "user_fast_acquir": 4, "save": 4, "usermod": 4, "printk_addr": 4, "submit": 4, "printk": 4, "interpret": [4, 5], "arg": 4, "panic_extend": 4, "mix": 4, "bug": 4, "create_tmp_snapshot": 4, "increment": 4, "posit": 4, "support": [4, 5], "debug_tmp_snapshot": 4, "nested_": 4, "roughli": 4, "equival": 4, "nest": 4, "l2": 4, "user_range_advis": 4, "get_argv": 4, "idea": 4, "get_program": 4, "deprec": 4, "gen": 5, "6": 5, "sever": 5, "onc": 5, "contain": 5, "userspac": 5, "workflow": 5, "debian": 5, "bullsey": 5, "venv": 5, "apt": 5, "captur": 5, "ansibl": 5, "playbook": 5, "ask": 5, "passwordless": 5, "skip": 5, "press": 5, "enter": 5, "remot": 5, "deploy": 5, "inventori": 5, "accord": 5, "remov": 5, "line": 5, "localhost": 5, "ansible_connect": 5, "home": 5, "node": 5, "proxi": 5, "group_var": 5, "yml": 5, "document": 5, "how": 5, "env": 5, "repo": 5, "install_dir": 5, "tag": 5, "suitabl": 5, "out": 5, "box": 5, "zephyr": 5, "rto": 5, "open": 5, "wip": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"get": [0, 2, 5], "start": [0, 2, 5], "linux": [0, 1], "fuzz": [0, 1, 2], "prepar": [0, 1, 2], "vm": [0, 1, 2], "imag": [0, 1, 2], "option": [0, 4], "1": 0, "full": 0, "instal": [0, 5], "manual": 0, "2": 0, "build": 0, "from": 0, "filesystem": 0, "autom": 0, "snapshot": [0, 2], "us": 1, "nyx": [1, 4], "htool": 1, "sharedir": 1, "o": 1, "creat": 1, "deploi": 1, "loader": 1, "script": 1, "launch": 1, "note": 1, "window": 2, "base": 2, "obtain": 2, "driver": 2, "virtual": 2, "address": 2, "rang": 2, "troubleshoot": 2, "kafl": [3, 4], "": 3, "document": 3, "featur": 3, "compon": 3, "content": 3, "tutori": 3, "how": 3, "To": 3, "guid": 3, "refer": 3, "hypercal": 4, "api": 4, "essenti": 4, "further": 4, "untest": 4, "fulli": 4, "integr": 4, "requir": 5, "next": 5, "step": 5, "activ": 5, "environ": 5, "exampl": 5, "target": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})